<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <fieldset style="width: 800px;margin:0 auto;">
        <legend>用户登录</legend>
        <p>用户姓名：<input type="text" class="username"></p>
        <p>用户密码：<input type="password" class="password"></p>
        <p><input type="button" value="用户登录" class="login"> <a href="3.registry.html">请注册</a></p>
        </form>
    </fieldset>
</body>
<script src="./callback.js"></script>
<!-- 加密的软件引入保证其安全 -->
<script src="7.sha1.js"></script>
<script>
    const login = document.querySelector('.login');
    const username = document.querySelector('.username');
    const password = document.querySelector('.password');

    // 登录：将前端的用户名和密码密码传递给后端
    login.onclick = function() {
        ajax({
            type: 'post',
            url: 'http://localhost/8-17_HTML/registry/php/4.login.php',
            data: {
                user: username.value,
                pass: hex_sha1(password.value)
            },
            success: function(data) {
                if (!data) { //不通过
                    alert('用户名或者密码错误');
                    username.value = '';
                    password.value = '';

                } else {
                    //存储用户名到本地
                    localStorage.setItem('user', username.value)
                        //通过调到首页
                    location.href = '1.index.html'
                }
            }

        })
    }
</script>

</html>